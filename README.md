# esphome-tion-ha-lovelace

Проект с конфигурациями ESPHome для управления бризером **Тион** и интеграции с Home Assistant. Репозиторий содержит только ESPHome-файлы; шаблоны Lovelace и дополнительные пакеты Home Assistant вынесены во внешние проекты.

## Возможности

- Автоматический режим управления скоростью бризера на основе уровня CO₂ и внешних датчиков.
- Переключение между ручным и автоматическим режимами с фиксацией допустимого диапазона скоростей.
- Служебные скрипты для синхронизации состояний и расширенных функций устройства.

## Что нового

- 2025-10 — очищен репозиторий, оставлены только ESPHome-конфигурации; README обновлён.
- 2024-06 — управление скоростью переведено на целочисленные расчёты и жёсткий диапазон 0–6.
- 2024-03 — логика автоматики вынесена в отдельный ESPHome-пакет.

## Требования

- Home Assistant 2023.12+
- ESPHome 2023.12+
- Бризер Tion с прошивкой ESPHome и датчик MagicAir (или другой источник CO₂).

## Содержимое репозитория

- `esphome/tion_auto_mode.yaml` — основной пакет ESPHome, расширяющий [esphome-tion](https://github.com/dentra/esphome-tion) автоматикой по CO₂ и сценариями.
- `esphome/tion_set_fan_speed.yaml` — API-сервис и сценарий для ручной установки скоростей и подготовки диапазонов.
- `esphome/tion_others.yaml` — дополнительные глобальные настройки, датчики и вспомогательные сущности.

## Быстрый старт

1. Склонируйте репозиторий и скопируйте каталог `esphome/` в конфигурацию ESPHome.
2. Обновите блоки `substitutions` и `globals` под ваши устройства и датчики.
3. Скомпилируйте и прошейте прошивку через ESPHome.
4. Настройте автоматизации и карточки в Home Assistant по своему усмотрению (готовые шаблоны в репозиторий не входят).

## Подключение пакета в ESPHome

```yaml
# substitutions:
#   # Добавьте данную подстановку с указанием имени сенсора CO2 в раздел substitutions
#   auto_mode_co2_sensor: sensor.chrn_kitchen_co2
#
# packages:
#   # Добавьте данный пакет в раздел packages
#   tion_auto_mode:
#     url: https://github.com/dima11235/esphome-tion-ha-lovelace
#     files:
#       # Автоматическое управление скоростью по уровню CO2
#       - esphome/tion_auto_mode.yaml
#       # Добавляет вызов HA, позволяющий устанавливать диапазон скоростей из интерфейса
#       - esphome/tion_set_fan_speed.yaml
#       # Дополнительные необязательные сенсоры, пополняемые по мере надобности
#       - esphome/tion_others.yaml
```

## Поддержка

Конфигурации поддерживаются «по мере возможности». Используйте их на свой страх и риск, создавайте issue или пул-реквест, если обнаружите ошибки или хотите предложить улучшения.
